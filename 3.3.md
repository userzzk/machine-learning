# machine-learning
>>> import numpy as np
>>> from sklearn.model_selection import train_test_split
>>> from sklearn.metrics import classification_report

>>> density=np.array([0.697,0.774,0.634,0.608,0.556,0.403,0.481,0.437,0.666,0.243,0.245,0.343,0.639,0.657,0.360,0.593,0.719]).reshape(-1,1)
>>> sugar_rate=np.array([0.460,0.376,0.264,0.318,0.215,0.237,0.149,0.211,0.091,0.267,0.057,0.099,0.161,0.198,0.370,0.042,0.103]).reshape(-1,1)
>>> 
xtrain=np.hstack((density,sugar_rate))
>>> xtrain=np.hstack((np.ones([density.shape[0],1]),xtrain))
>>> ytrain=np.array([1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0]).reshape(-1,1)
>>> xtrain,xtest,ytrain,ytest=train_test_split(xtrain,ytrain,test_size=0.25,random_state=33)
>>> def sigmoid(z):
        return 1/(1+np.exp(-z))

>>> 
#print(sigmoid(density))
>>> 
def logit_regression(theta,x,y,iteration=100,learning_rate=0.1,lbd=0.01):
    for i in range(iteration):
        theta=theta-learning_rate/y.shape[0]*(np.dot(x.transpose(),(sigmoid(np.dot(x,theta))-y))+lbd*theta)
        cost=-1/y.shape[0]*(np.dot(y.transpose(),np.log(sigmoid(np.dot(x,theta))))+np.dot((1-y).transpose(),np.log(1-sigmoid(np.dot(x,theta)))))+lbd/(2*y.shape[0])*np.dot(theta.transpose(),theta)
        print('---------Iteration %d,cost is %f-------------'%(i,cost))
    return theta

>>> def predict(theta,x):
    pre=np.zeros([x.shape[0],1])
    for idx,valu in enumerate(np.dot(x,theta)):
        if sigmoid(valu)>=0.5:
            pre[idx]=1
        else:
            pre[idx]=0
    return pre

>>> theta_init=np.random.rand(3,1)
>>> pre=predict(theta,xtest)
回溯（最后调用）:
  File "<pyshell#17>", line 1, in <module>
    pre=predict(theta,xtest)
NameError: name 'theta' is not defined
>>> pre=predict(theta_init,xtest)
>>> theta=logit_regression(theta_init,xtrain,ytrain,learning_rate=1)
---------Iteration 0,cost is 0.880228-------------
---------Iteration 1,cost is 0.774772-------------
---------Iteration 2,cost is 0.719710-------------
---------Iteration 3,cost is 0.692956-------------
---------Iteration 4,cost is 0.680263-------------
---------Iteration 5,cost is 0.674179-------------
---------Iteration 6,cost is 0.671143-------------
---------Iteration 7,cost is 0.669511-------------
---------Iteration 8,cost is 0.668528-------------
---------Iteration 9,cost is 0.667847-------------
---------Iteration 10,cost is 0.667309-------------
---------Iteration 11,cost is 0.666838-------------
---------Iteration 12,cost is 0.666402-------------
---------Iteration 13,cost is 0.665983-------------
---------Iteration 14,cost is 0.665575-------------
---------Iteration 15,cost is 0.665173-------------
---------Iteration 16,cost is 0.664776-------------
---------Iteration 17,cost is 0.664384-------------
---------Iteration 18,cost is 0.663995-------------
---------Iteration 19,cost is 0.663610-------------
---------Iteration 20,cost is 0.663229-------------
---------Iteration 21,cost is 0.662851-------------
---------Iteration 22,cost is 0.662476-------------
---------Iteration 23,cost is 0.662104-------------
---------Iteration 24,cost is 0.661736-------------
---------Iteration 25,cost is 0.661371-------------
---------Iteration 26,cost is 0.661010-------------
---------Iteration 27,cost is 0.660651-------------
---------Iteration 28,cost is 0.660296-------------
---------Iteration 29,cost is 0.659944-------------
---------Iteration 30,cost is 0.659595-------------
---------Iteration 31,cost is 0.659249-------------
---------Iteration 32,cost is 0.658906-------------
---------Iteration 33,cost is 0.658566-------------
---------Iteration 34,cost is 0.658229-------------
---------Iteration 35,cost is 0.657895-------------
---------Iteration 36,cost is 0.657564-------------
---------Iteration 37,cost is 0.657236-------------
---------Iteration 38,cost is 0.656911-------------
---------Iteration 39,cost is 0.656588-------------
---------Iteration 40,cost is 0.656269-------------
---------Iteration 41,cost is 0.655952-------------
---------Iteration 42,cost is 0.655638-------------
---------Iteration 43,cost is 0.655326-------------
---------Iteration 44,cost is 0.655018-------------
---------Iteration 45,cost is 0.654712-------------
---------Iteration 46,cost is 0.654408-------------
---------Iteration 47,cost is 0.654107-------------
---------Iteration 48,cost is 0.653809-------------
---------Iteration 49,cost is 0.653514-------------
---------Iteration 50,cost is 0.653220-------------
---------Iteration 51,cost is 0.652930-------------
---------Iteration 52,cost is 0.652642-------------
---------Iteration 53,cost is 0.652356-------------
---------Iteration 54,cost is 0.652073-------------
---------Iteration 55,cost is 0.651792-------------
---------Iteration 56,cost is 0.651514-------------
---------Iteration 57,cost is 0.651238-------------
---------Iteration 58,cost is 0.650964-------------
---------Iteration 59,cost is 0.650693-------------
---------Iteration 60,cost is 0.650424-------------
---------Iteration 61,cost is 0.650157-------------
---------Iteration 62,cost is 0.649893-------------
---------Iteration 63,cost is 0.649630-------------
---------Iteration 64,cost is 0.649370-------------
---------Iteration 65,cost is 0.649112-------------
---------Iteration 66,cost is 0.648857-------------
---------Iteration 67,cost is 0.648603-------------
---------Iteration 68,cost is 0.648352-------------
---------Iteration 69,cost is 0.648102-------------
---------Iteration 70,cost is 0.647855-------------
---------Iteration 71,cost is 0.647610-------------
---------Iteration 72,cost is 0.647367-------------
---------Iteration 73,cost is 0.647126-------------
---------Iteration 74,cost is 0.646887-------------
---------Iteration 75,cost is 0.646650-------------
---------Iteration 76,cost is 0.646415-------------
---------Iteration 77,cost is 0.646181-------------
---------Iteration 78,cost is 0.645950-------------
---------Iteration 79,cost is 0.645721-------------
---------Iteration 80,cost is 0.645493-------------
---------Iteration 81,cost is 0.645268-------------
---------Iteration 82,cost is 0.645044-------------
---------Iteration 83,cost is 0.644822-------------
---------Iteration 84,cost is 0.644602-------------
---------Iteration 85,cost is 0.644384-------------
---------Iteration 86,cost is 0.644167-------------
---------Iteration 87,cost is 0.643953-------------
---------Iteration 88,cost is 0.643740-------------
---------Iteration 89,cost is 0.643528-------------
---------Iteration 90,cost is 0.643319-------------
---------Iteration 91,cost is 0.643111-------------
---------Iteration 92,cost is 0.642905-------------
---------Iteration 93,cost is 0.642701-------------
---------Iteration 94,cost is 0.642498-------------
---------Iteration 95,cost is 0.642297-------------
---------Iteration 96,cost is 0.642097-------------
---------Iteration 97,cost is 0.641899-------------
---------Iteration 98,cost is 0.641703-------------
---------Iteration 99,cost is 0.641508-------------
>>> print('predictions are',pre)
predictions are [[1.]
 [1.]
 [1.]
 [1.]
 [1.]]
>>> print('ground truth is',ytest)
ground truth is [[1]
 [1]
 [0]
 [1]
 [0]]
>>> print('theta is ',theta)
theta is  [[-1.25141661]
 [ 1.48024634]
 [ 1.07814861]]
>>> print('the accuracy is',np.mean(pre==ytest))
the accuracy is 0.6
>>> print(classification_report(ytest,pre,target_names=['Bad','Good']))

警告（来自警告模块）:
  文件 "D:\Python\lib\site-packages\sklearn\metrics\classification.py", 行 1143
    'precision', 'predicted', average, warn_for)
UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
              precision    recall  f1-score   support

         Bad       0.00      0.00      0.00         2
        Good       0.60      1.00      0.75         3

   micro avg       0.60      0.60      0.60         5
   macro avg       0.30      0.50      0.37         5
weighted avg       0.36      0.60      0.45         5

>>> 

